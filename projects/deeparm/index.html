<!doctype html><html><head><title></title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><meta property="og:title" content><meta property="og:description" content="Inverse Kinematics solver using deep learning While exploring inverse kinematics for the control of robotic arms, I came across an article on MATLAB about using their adaptive neuro-fuzzy inference system (ANFIS) app to model a 2-joint robotic arm in a 2D space. The approach seemed like it could overcome the exponential increase in complexity with more complex systems, so I decided to give it a try using Tensorflow to train a model for the control of a 2-joint robotic arm in 3D space."><meta property="og:type" content="article"><meta property="og:url" content="http://jiahe.dev/projects/deeparm/"><meta property="article:section" content="projects"><meta name=description content><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/projects/single.css><link rel=stylesheet href=/css/style.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYP6PRXS0T"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYP6PRXS0T",{anonymize_ip:!1})}</script></head><body><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/>My Technical portfolio</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div></nav><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class=page-content><div class=title><h1></h1></div><div class=post-content id=post-content><h1 id=inverse-kinematics-solver-using-deep-learning>Inverse Kinematics solver using deep learning</h1><p>While exploring inverse kinematics for the control of robotic arms, I came across an article on MATLAB about using their adaptive neuro-fuzzy inference system (ANFIS) app to model a 2-joint robotic arm in a 2D space. The approach seemed like it could overcome the exponential increase in complexity with more complex systems, so I decided to give it a try using Tensorflow to train a model for the control of a 2-joint robotic arm in 3D space.</p><p>The data was generated in python using a forward kinematics solution to find all possible states of the arm for discrete intervals of the actuation of each joint, chosen to ensure a managable amount of data. The data was then processed by shuffling it and splitting the input, a position in catesian coordinates from the output, the required actuation from each joint. The first model I trained consisted of hidden dense layers with relu activation and a mean squared error loss function just to see how it would perform. The model was able to provide actuator commands for points within its reach with decent accuracy. However, it requested actuator commands greater than the limits present in the data, representing impossible demands, and was unable to produce meaningful output for objects out of its reach.</p><p>To solve some of these problems, I implemented a custom loss function to reduce the eucliean distance of the position calcuated from the angles produced by the model using forward kinematics to the desired input position. This allowed the model to better evaluate its solution by minimising the offset from the desired position rather than just comparing it to known solutions. In addition, I generated a more balanced dataset using a range of points in and around the reach of the arm. This reduced the model overfitting to positions with more solutions, as well as being unable to estimate a solution for points it could not reach, allowing the model to accurately generate angles for points it could reach and extend in the right direction for points out of reach.</p><p>A simple webapp made with Threejs utilizing the trained model can be found at <a href=https://deep-arm.netlify.app/>https://deep-arm.netlify.app/</a>.</p></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=http://jiahe.dev/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=http://jiahe.dev/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=http://jiahe.dev/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=http://jiahe.dev/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=http://jiahe.dev/#projects>Projects</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>yi.jiahe00@gmail.com</span></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form method=post action=https://blogtrottr.com><div class=form-group><input type=email class=form-control name=btr_email placeholder="Enter email"><br><input type=hidden name=btr_url value=http://jiahe.dev/index.xml>
<input type=hidden name=schedule_type value=1>
<small id=emailHelp class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small>
<button type=submit class="btn btn-info"> Submit</button></form></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">Â© 2021 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>